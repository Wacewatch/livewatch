<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exemple d'int√©gration LiveWatch en iframe</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: system-ui, -apple-system, sans-serif;
            background: #1a1a1a;
            color: white;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        h1 {
            margin-bottom: 20px;
        }
        .info {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .info code {
            background: #3a3a3a;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }
        iframe {
            width: 100%;
            height: 800px;
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé¨ LiveWatch - Int√©gration iframe</h1>
        
        <div class="info">
            <p><strong>Note:</strong> Cette page montre comment int√©grer LiveWatch en iframe tout en partageant l'authentification de votre site.</p>
            <p>R√¥le actuel simul√©: <code id="current-role">admin</code></p>
        </div>

        <iframe 
            id="livewatch-iframe"
            src="https://v0-tvchannelstreamer11-seven.vercel.app/channels/France"
            allow="autoplay; fullscreen; picture-in-picture"
            allowfullscreen
        ></iframe>
    </div>

    <script>
        // Simuler les donn√©es d'authentification de votre site
        // En production, remplacez ceci par vos vraies donn√©es utilisateur
        const userAuthData = {
            role: 'admin', // Peut √™tre: 'admin', 'vip', 'member'
            userId: 'user-12345',
            email: 'admin@example.com',
            token: 'your-auth-token-here'
        };

        const iframe = document.getElementById('livewatch-iframe');

        // √âcouter les demandes d'authentification de l'iframe
        window.addEventListener('message', (event) => {
            // V√©rifier que le message vient bien de l'iframe LiveWatch
            // En production, v√©rifiez l'origine: event.origin === 'https://votre-domaine.com'
            
            if (event.data && event.data.type === 'auth-request') {
                console.log('üì® Iframe demande l\'authentification');
                
                // Envoyer les donn√©es d'authentification √† l'iframe
                iframe.contentWindow.postMessage({
                    type: 'auth-response',
                    role: userAuthData.role,
                    userId: userAuthData.userId,
                    email: userAuthData.email,
                    token: userAuthData.token
                }, '*'); // En production, remplacez '*' par votre domaine exact
                
                console.log('‚úÖ Authentification envoy√©e √† l\'iframe:', userAuthData.role);
            }
        });

        // Attendre que l'iframe soit charg√©e puis envoyer l'auth
        iframe.addEventListener('load', () => {
            console.log('üé¨ Iframe LiveWatch charg√©e');
            
            // Envoyer l'authentification automatiquement au chargement
            setTimeout(() => {
                iframe.contentWindow.postMessage({
                    type: 'auth-response',
                    role: userAuthData.role,
                    userId: userAuthData.userId,
                    email: userAuthData.email,
                    token: userAuthData.token
                }, '*');
                
                console.log('‚úÖ Authentification initiale envoy√©e');
            }, 1000);
        });

        // Afficher le r√¥le actuel
        document.getElementById('current-role').textContent = userAuthData.role;
    </script>
</body>
</html>
